<div class="contenido" [ngClass]="{ 'authenticated': userAuthenticated }">
  <h3>{{ greetingMessage }}</h3>
  <h4 *ngIf="!userAuthenticated">Por favor, inicia sesión para ver contenido personalizado</h4>
  <h2 class="titulo-planificacion">Planificación Para Esta Semana</h2> <!-- Cambié a <h2> -->
  
  <div class="semana mt-4">
    <div *ngFor="let day of daysOfWeek" 
         class="day-container" 
         [class.active]="day.isToday"
         (click)="onSelectDate(day)">
      <div class="day">
        <h2>{{ day.day }}</h2>
        <h6 class="fecha">{{ day.date }}</h6>
        <h6 *ngIf="day.isToday" class="hoy">Hoy</h6>
      </div>
    </div>
    <div class="plan-futuro" (click)="redirectToPlanificacion()">&#62;&#62;&#62;</div>
  </div>
</div>


<div class="row mt-4">
  <div class="col-6">
    <div class="contenido">
      <h4>Tandas más recientes añadidas</h4>
      <!-- Carrusel de tandas recientes -->
      <p-carousel 
        [value]="tandasRecientes" 
        [numVisible]="1" 
        [numScroll]="1" 
        [circular]="true" 
        [autoplayInterval]="6000">
        
        <ng-template pTemplate="item" let-tanda let-i="index">
          <div class="tanda-card">
            <h5>Tanda #{{ tandasRecientes.indexOf(tanda) + 1 }}</h5>
            <p><strong>Producto:</strong> {{ tanda.producto }}</p>
            <p><strong>Cantidad Ingresada:</strong> {{ tanda.cantidadIngresada }}</p>
            <p><strong>Cantidad Actual:</strong> {{ tanda.cantidadActual }}</p>
            <p><strong>Fecha de Llegada:</strong> {{ tanda.fechaLlegada | date }}</p>
            <p><strong>Fecha de Vencimiento:</strong> {{ tanda.fechaVencimiento | date }}</p>
            <p><strong>Bodega:</strong> {{ tanda.bodega }}</p>
            <p><strong>Ubicación:</strong> {{ tanda.ubicacion }}</p>
          </div>
        </ng-template>
      </p-carousel>

      <ng-template #noTandas>
        <p>No se encontraron tandas recientes.</p>
      </ng-template>
    </div>
  </div>

  <div class="col-6">
    <p-card header="Planificación del Día {{ selectedDayName }}" styleClass="contenido planificacion" [style]="{ 'width': '100%' }">
      
      <!-- Verifica si hay datos de planificación y si hay detalles -->
      <div *ngIf="planningData && planningData.detalles?.length > 0; else noPlanificacion">
        <p><strong>Fecha:</strong> {{ planningData.fecha }}</p>
        <p><strong>Detalles:</strong></p>
  
        <!-- Scroll panel para los detalles de planificación -->
        <p-scrollPanel [style]="{ 'max-height': '250px', 'overflow-y': 'auto', 'margin-top': '10px' }">
          <ul style="list-style-type: none; padding: 0; margin: 0;">
            <li *ngFor="let detalle of planningData.detalles" class="detalle-item" style="margin-bottom: 10px; padding: 10px; border-bottom: 1px solid #ddd;">
              <div class="detalle-imagen">
                <img [src]="detalle.urlImagen" alt="{{ detalle.producto }}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;">
              </div>
              <p><strong>Producto:</strong> {{ detalle.producto }}</p>
              <p><strong>Cantidad Planificada:</strong> {{ detalle.cantidadPlanificada }}</p>
              <p><strong>Estado:</strong> 
                <span [ngClass]="{ 'estado-completo': detalle.isComplete, 'estado-pendiente': !detalle.isComplete }">
                  {{ detalle.isComplete ? 'Completo' : 'Pendiente' }}
                </span>
              </p>
            </li>
          </ul>
        </p-scrollPanel>
      </div>
  
      <!-- Mensaje cuando no hay planificación o detalles disponibles -->
      <ng-template #noPlanificacion>
        <p>No se encontró planificación para la fecha seleccionada.</p>
      </ng-template>
      
      <!-- Botón de planificación, visible en ambos casos -->
      <button (click)="redirectToPlanificacion()" class="btn-redirect">
        <i class="bi bi-calendar-week"></i> Planificar
      </button>
  
    </p-card>
  </div>
  
  
  
  
</div>

  


<div class="contenido">
  dashboard
</div>